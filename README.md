# Анализатор погоды (Weather analyzer)

### **Для взаимодействия с приложением:**
1. Скачать репозиторий https://github.com/anpoliakov/wallet-service.git
2. Опустим момент регистрации и получения ключа для API запросов на сайте https://openweathermap.org/ (ключ используем мой).
3. В настройках проекта application.yml в поле weather.city - указываем город по которому будем производить мониторинг погоды.
4. В поле этого же файла weather.delay.scan - указываем время в миллисекундах, через которое будем запрашивать данные с API и заполнять БД.
5. В файле application.yml раскомментировать выбранный вами вариант запуска приложения (имеются комментарии в самом файле - обязательно к прочтению).
6. Варианты запуска:  
* **первый, через Docker**: при помощи `maven install` (через консоль используя mvn или просто ручками через IDEA) получаем jar архив приложения и запускаем консольной командой `sudo docker compose up` (находимся в корневой папке проекта, на вашем компьютере должнен присутствовать Docker);   
* **второй, через intelliJ IDEA**: при помощи предустановленной бд `PostgreSQL` с созданной таблицей `weather_analyzer` и пользователем логин/пароль: senla (не забываем предоставить права доступа к бд) входная точка приложения `by/anpoliakov/WeatherAnalyzerRunner.class`, дополнительно в файле `resources/application.properties` закомментировать необходимый вариант запуска;

### Первый endpoint:
**GET request** по адрессу http://localhost:8080/weatherEntity -> **response** JSON с последней актуальной инфомацией из БД
  
### Второй endpoint:
**POST request** по адрессу http://localhost:8080/weatherEntity c телом запроса формата JSON, содержащий:
`{  
 "from":"22-08-2021",   
 "to":"24-08-2021"  
} `  
и необязательно требование: заголовок Content-Type:application/json; charset=UTF-8 -> **response** JSON с среднесуточной информацией о погоде, в заданных датах.

#### Заметки:
* Запуск/разработка проекта производилась на Linux Ubuntu 22.04 
* Предустановленны changesets и Liquibase (миграция базы данных)
* Поднятие PostgreSQL, Liquibase, приложения через Docker compose

#### Проблемы:
* Со вторым endpoint при запуске через Docker (а именно с нативным @Query интерфейса WeatherRepository)
